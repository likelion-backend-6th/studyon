{% extends "base.html" %}
{% block content %}
    <ul class="container mx-auto max-w-3xl pt-6">
        {% for register in registers %}
            <li class="border-b py-4 last:border-none first:pt-0 last:pb-0">
                <h3 class="text-xl">{{ register.requester.username }}</h3>
                <p>{{ register.content }}</p>
                <div class="flex justify-end">
                    <form onsubmit="recruit_confirm('{{ register.recruit }}','{{ register.requester.pk }}')"
                          action="{% url 'recruits:confirm_request' register.pk %}"
                          method="post">
                        {% csrf_token %}
                        <input type="submit"
                               value="confirm"
                               class="bg-cyan-500 text-white p-1 rounded-md mr-3 cursor-pointer">
                    </form>
                    <form onsubmit="recruit_cancel('{{ register.recruit }}','{{ register.requester.pk }}')"
                          action="{% url 'recruits:cancel_request' register.pk %}"
                          method="post">
                        {% csrf_token %}
                        <input type="submit"
                               value="cancel"
                               class="bg-red-500 text-white p-1 rounded-md cursor-pointer">
                    </form>
                </div>
            </li>
        {% empty %}
            <li>신청자가 없습니다.</li>
        {% endfor %}
    </ul>
{% endblock content %}
{% block websocket %}
    function recruit_confirm(recruit, user_id) {
    var notice = {
    "content" :  recruit+"의 참가신청이 수락되었습니다.",
    "user_id" : user_id
    };
    notice_socket.send(JSON.stringify(notice));
    };
    function recruit_cancel(recruit, user_id) {
    var notice = {
    "content" :  recruit+"의 참가신청이 거절되었습니다.",
    "user_id" : user_id
    };
    notice_socket.send(JSON.stringify(notice));
    };
{% endblock websocket %}
